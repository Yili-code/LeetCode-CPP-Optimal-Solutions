# monotonic_stack

## 1. 基本定義 (Basic Definition)
- **資料結構 (Data Structure)**：  
  單調棧（Monotonic Stack）是一種特殊的 stack，**棧內元素保持單調遞增或遞減的順序**。  

- **元素特性**：  
  - 保持棧內元素有序（嚴格遞增或嚴格遞減）。  
  - 新元素入棧時，會彈出所有違反單調性的元素，確保棧序維持單調。  

- **主要用途**：  
  快速解決涉及「下一個更大/更小元素」、「區間最大值」、「直方圖最大矩形」等問題。

---

## 2. 底層實現原理 (Underlying Implementation)
- 以普通 stack 為基礎，但入棧前會**比較新元素與棧頂元素**：  
  - 若違反單調規則（例如單調遞增棧中，新元素小於棧頂），則持續彈出棧頂元素。  
  - 最終棧內保持所需的單調性，且每個元素最多被推入和彈出一次，時間複雜度為 O(n)。  

- 常搭配索引入棧，以便回溯元素位置。

---

## 3. 常見操作與時間複雜度 (Common Operations & Complexity)
| 操作                  | 描述                            | 時間複雜度 (Time Complexity) |
|-----------------------|---------------------------------|------------------------------|
| 入棧（Push）          | 根據單調規則彈出不合元素後入棧 | 均攤 O(1)                   |
| 出棧（Pop）           | 彈出違反單調性的元素             | 均攤 O(1)                   |
| 讀取棧頂元素 (Top)    | 查看棧頂元素                    | O(1)                        |
| 遍歷整個輸入資料      | 單趟線性掃描                    | O(n)                        |

---

## 4. 與相近資料結構比較 (Comparison with Similar Data Structures)

| 資料結構        | 順序規則           | 適用場景                         |
|-----------------|--------------------|---------------------------------|
| **stack**       | 無固定順序          | 一般的 LIFO 操作                 |
| **monotonic stack** | 保持單調遞增或遞減 | 解決下一個更大/更小元素、最大矩形等問題 |

---

## 5. 使用情境 (Usage Scenarios)
- **下一個更大元素 (Next Greater Element)** 類問題。  

- **直方圖最大矩形面積**問題。  

- **滑動窗口最大值**（可與雙端隊列結合）。  

- **股票價格分析**（如「每日溫度」問題求下一個更暖日）。  

- 任何需要在 O(n) 內求解區間最大/最小的問題。

---

## 6. 較少人思考的點 (Less-Discussed Points)
1. **元素入棧和出棧的總操作次數**  
   - 每個元素最多入棧出棧各一次，因此整體均攤時間為 O(n)，非單純每次操作 O(1)。  

2. **使用索引入棧以解決位置問題**  
   - 不只存值，存索引方便快速計算距離或區間大小。  

3. **單調棧有兩種方向**  
   - 單調遞增棧與單調遞減棧，依題目需求選擇。  

4. **對相等元素的處理**  
   - 單調規則可設定為嚴格或非嚴格（`<` 或 `<=`），影響結果細節。  
   
5. **與單調隊列（Monotonic Queue）的差異**  
   - 單調棧用於後退式範圍分析，單調隊列用於滑動窗口問題。

---

## 7. LeetCode 經典題目 (Classic Problems)

| 題號 | 題名                           | 重點                              |
|------|--------------------------------|-----------------------------------|
| 84   | Largest Rectangle in Histogram | 用單調棧計算最大矩形面積           |
| 42   | Trapping Rain Water            | 利用單調棧求解蓄水問題             |
| 739  | Daily Temperatures             | 求下一個更暖日，單調棧解法         |
| 496  | Next Greater Element I         | 利用單調棧找下一個更大元素         |
| 901  | Online Stock Span              | 用單調棧快速計算股票跨度           |

---
